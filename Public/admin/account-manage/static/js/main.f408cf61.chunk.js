(this["webpackJsonpmanage-user"]=this["webpackJsonpmanage-user"]||[]).push([[0],{259:function(e,t,a){},260:function(e,t,a){},355:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(36),c=a.n(s),i=(a(259),a(47)),o=a(48),l=a(187),d=a(54),u=a(53),j=(a(260),a(142),a(247)),m=a(244),p=(a(354),a(225),a(19));var b=a(248),h=a.n(b),g=a(64),O=a(83),x=a(103),f=a.n(x),y=function(e,t){localStorage.token&&f.a.ajax({type:"GET",url:"https://sv-communityadvocates.org/api/react/users/",headers:{Authorization:"token "+localStorage.token},error:function(e){console.log("Error: ",e),t&&t(e)},success:function(t){console.log("Success: ",t),e&&e(t)}})},v=a(152),k=a(34),C=a(245),S=a(59),I=a(246),_=a(116),w=a(71),F=a(237),E=S.a.Option;var A=function(e){var t=I.a.useForm(),a=Object(O.a)(t,1)[0],r=Object(n.useState)(!0),s=Object(O.a)(r,2),c=s[0],i=s[1],o=[Object(p.jsx)(E,{value:3,children:"Admin"},"3"),Object(p.jsx)(E,{value:4,children:"Super user"},"4"),Object(p.jsx)(E,{value:1,children:"Member"},"1"),Object(p.jsx)(E,{value:2,children:"User"},"2"),Object(p.jsx)(E,{value:5,children:"Site editor"},"5")];return Object(p.jsx)("div",{children:Object(p.jsxs)(I.a,{form:a,layout:"horizontal",initialValues:{username:e.record.username,email:e.record.email,first_name:e.record.first_name,last_name:e.record.last_name,groups:e.record.groups},onFinish:function(t){console.log("Succcess: ",t),console.log(typeof t),f.a.ajax({type:"PATCH",url:"https://sv-communityadvocates.org/api/react/users/"+e.record.id+"/",headers:{Authorization:"token "+localStorage.token},data:JSON.stringify(t),contentType:"application/json",error:function(t){console.log("error: ",t),v.a.error({message:"An error happened",description:e.record.username+"'s information is not updated, please try again."}),e.updateCallback&&e.updateCallback()},success:function(t){v.a.success({message:"User info updated",description:e.record.username+"'s information has been updated successfully!"}),e.updateCallback&&e.updateCallback()}})},children:[Object(p.jsx)(I.a.Item,{label:"Username",name:"username",children:Object(p.jsx)(_.a,{placeholder:"Username",disabled:c})}),Object(p.jsx)(I.a.Item,{label:"Email",name:"email",children:Object(p.jsx)(_.a,{type:"email",placeholder:"Email"})}),Object(p.jsx)(I.a.Item,{label:"First name",name:"first_name",children:Object(p.jsx)(_.a,{placeholder:"First name"})}),Object(p.jsx)(I.a.Item,{label:"Last name",name:"last_name",children:Object(p.jsx)(_.a,{placeholder:"Last name"})}),Object(p.jsx)(I.a.Item,{label:"Permision groups",name:"groups",children:Object(p.jsx)(S.a,{mode:"multiple",allowClear:!0,style:{minWidth:"230px"},value:e.record.groups,placeholder:"Please select which permission group you want this user to be in",children:o})}),Object(p.jsx)(I.a.Item,{children:Object(p.jsx)(w.a,{checked:c,onChange:function(){return c?a.setFieldsValue({username:e.record.username}):a.setFieldsValue({username:a.getFieldsValue().email}),void i(!c)},children:"Same username and password"})}),Object(p.jsxs)(I.a.Item,{children:[Object(p.jsx)(k.a,{type:"primary",htmlType:"submit",children:"Update"}),Object(p.jsx)(F.a,{placement:"topRight",title:"This action cannot be undo, do you want to continue?",okText:"Yes",onConfirm:function(){f.a.ajax({type:"DELETE",url:"https://sv-communityadvocates.org/api/react/users/"+e.record.id+"/",headers:{Authorization:"token "+localStorage.token},error:function(t){console.log("error: ",t),v.a.error({message:"An error happened",description:e.record.username+"'s account is not deleted, please try again."}),e.updateCallback&&e.updateCallback()},success:function(t){v.a.success({message:"User deleted",description:e.record.username+"'s information has been deleted!"}),e.updateCallback&&e.updateCallback()}})},children:Object(p.jsx)(k.a,{style:{float:"right"},danger:!0,type:"primary",children:"Delete"})})]})]})})};var T=function(e){var t=Object(n.useState)(null),a=Object(O.a)(t,2),r=a[0],s=a[1],c=Object(n.useState)([]),i=Object(O.a)(c,2),o=i[0],l=i[1],d=function(e){var t=Object(g.a)(o);t.includes(e.id)?t.splice(o.indexOf(e.id),1):t.push(e.id),l(Object(g.a)(t))};Object(n.useEffect)((function(){y((function(e){s(e)}),(function(e){v.a.error({message:"Unable to retrieve list of user!",description:"Please check your account permission?"})}))}),[]);var u=function(){y((function(e){s(e)}),(function(e){v.a.error({message:"Unable to retrieve list of user!",description:"Please check your account permission?"})}))},j=[{title:"ID",dataIndex:"id",key:"id"},{title:"Username",dataIndex:"username",key:"username"},{title:"Email",dataIndex:"email",key:"email"},{title:"First name",dataIndex:"first_name",key:"first_name"},{title:"Last name",dataIndex:"last_name",key:"last_name"},{title:"Date created",dataIndex:"date_joined",key:"date_joined",render:function(e){return Object(p.jsx)("div",{children:new Date(Date.parse(e)).toString()})}},{title:"Action",dataIndex:"id",render:function(e,t,a){return Object(p.jsx)("div",{children:Object(p.jsx)(k.a,{type:"",onClick:function(e){return d(t)},children:"Edit"})})}}];return Object(p.jsx)("div",{children:Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)("h2",{children:"Account manager"}),Object(p.jsx)("div",{className:"container",children:Object(p.jsx)(C.a,{dataSource:r,columns:j,expandable:{expandedRowRender:function(e){return Object(p.jsx)("div",{children:Object(p.jsx)(A,{record:e,updateCallback:u})})},expandIconColumnIndex:-1},expandedRowKeys:o,rowKey:"id"})})]})})},U=a(251),D=a.n(U),L=(m.a.Header,m.a.Sider),P=m.a.Content,N=function(e){Object(d.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).toggle=function(){n.setState({collapsed:!n.state.collapsed})},n.state={username:null,firstname:null,collapsed:!0,groups:[]},Object(j.getLogin)((function(e){n.setState({username:e.username,firstname:e.firstname,collapsed:!0,groups:e.groups})})),n.toggle=n.toggle.bind(Object(l.a)(n)),n}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return Object(p.jsx)("div",{children:Object(p.jsxs)(m.a,{children:[Object(p.jsx)(h.a,{siteName:"SVCA",username:this.state.username}),Object(p.jsxs)(m.a,{children:[Object(p.jsx)(L,{theme:"light",trigger:null,collapsible:!0,collapsed:this.state.collapsed,children:Object(p.jsx)(D.a,{permission_groups:this.state.groups,selected:"3",collapsed:this.state.collapsed,toggle:function(){return e.toggle()}})}),Object(p.jsx)(m.a,{className:"site-layout",style:{background:"white"},children:Object(p.jsx)(P,{className:"site-layout-background",children:Object(p.jsx)(T,{})})})]})]})})}}]),a}(n.Component),V=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,361)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),s(e),c(e)}))};c.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(N,{})}),document.getElementById("root")),V()}},[[355,1,2]]]);
//# sourceMappingURL=main.f408cf61.chunk.js.map