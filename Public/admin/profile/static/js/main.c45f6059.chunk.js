(this["webpackJsonpuser-profile"]=this["webpackJsonpuser-profile"]||[]).push([[0],{265:function(e,t,s){},267:function(e,t,s){},360:function(e,t,s){"use strict";s.r(t);var a=s(0),n=s.n(a),o=s(35),c=s.n(o),r=(s(265),s(246)),i=s(247),l=s(136),d=s(260),u=s(259),m=s(248),j=s.n(m),p=(s(267),s(131),s(249)),h=s(242),b=s(100),g=s(99),f=s(258),O=s(46),v=s.n(O);var x=function(e){localStorage.token?v.a.ajax({type:"GET",url:"https://sv-communityadvocates.org/api/react/myinfo/",headers:{Authorization:"token "+localStorage.token},success:function(t){e(t)},error:function(){console.log("error"),window.location.replace("/admin/login?redirect="+window.location.href)}}):window.location.replace("/admin/login?redirect="+window.location.href)},y=s(150),w=s(226),S=s(19);var k=function(e){var t=Object(a.useState)(null),s=Object(g.a)(t,2),n=s[0],o=s[1],c=Object(f.a)({initialValues:{username:"",first_name:"",last_name:"",email:"",password:""},onSubmit:function(e){console.log(e),v.a.ajax({type:"PATCH",url:"https://sv-communityadvocates.org/api/react/user/"+n.id+"/",data:e,headers:{Authorization:"token "+localStorage.token},error:function(e){console.log(e),y.a.error({message:"Update failed",description:"An error happened!"}),x((function(e){o(e)}))},success:function(e){console.log(e),y.a.success({message:"Update successfully",description:"Your account information has beed update successfully"}),x((function(e){o(e)}))}})}});return Object(a.useEffect)((function(){x((function(e){c.setFieldValue("email",e.email),c.setFieldValue("first_name",e.first_name),c.setFieldValue("last_name",e.last_name),c.setFieldValue("username",e.username),o(e),console.log(c)}))}),[]),Object(a.useEffect)((function(){c.values.email&&c.touched.email&&c.setFieldValue("username",c.values.email)}),[c.values.email,c.touched.email,c.setFieldValue]),Object(S.jsx)("div",{className:"container",children:Object(S.jsxs)("div",{className:"container-md rounded-3 p-3 m-3",children:[Object(S.jsx)(w.a,{orientation:"left",children:Object(S.jsx)("h2",{children:"Personal information"})}),Object(S.jsxs)("form",{onSubmit:c.handleSubmit,children:[Object(S.jsx)("div",{className:"row",children:Object(S.jsxs)("div",{className:"col my-2",children:[Object(S.jsx)("label",{htmlFor:"username",className:"form-label",children:"Username"}),Object(S.jsx)("input",Object(b.a)({id:"username",type:"text",className:"form-control",readOnly:!0},c.getFieldProps("username")))]})}),Object(S.jsxs)("div",{className:"row",children:[Object(S.jsxs)("div",{className:"col-sm",children:[Object(S.jsx)("label",{htmlFor:"first_name",className:"form-label",children:"First name"}),Object(S.jsx)("input",Object(b.a)({id:"first_name",type:"text",className:"form-control"},c.getFieldProps("first_name")))]}),Object(S.jsxs)("div",{className:"col-sm",children:[Object(S.jsx)("label",{htmlFor:"last_name",className:"form-label",children:"Last name"}),Object(S.jsx)("input",Object(b.a)({id:"last_name",type:"text",className:"form-control"},c.getFieldProps("last_name")))]})]}),Object(S.jsxs)("div",{className:"col-12 my-2",children:[Object(S.jsx)("label",{htmlFor:"email",className:"form-label",children:"Email"}),Object(S.jsx)("input",Object(b.a)({id:"email",type:"email",className:"form-control"},c.getFieldProps("email")))]}),Object(S.jsx)("div",{className:"col-12 my-2",children:Object(S.jsx)("button",{className:"btn btn-primary float-end",type:"submit",children:"Save"})})]})]})})},N=s(244);var F=function(e){var t=Object(a.useState)(null),s=Object(g.a)(t,2),n=s[0],o=s[1],c=Object(a.useState)({current:1,pageSize:10,total:24}),r=Object(g.a)(c,2),i=r[0],l=r[1],d=Object(a.useState)(!1),u=Object(g.a)(d,2),m=u[0],j=(u[1],function(e){v.a.ajax({type:"GET",url:"https://sv-communityadvocates.org/api/react/list-devices/",headers:{Authorization:"token "+localStorage.token},data:Object(b.a)({},i),error:function(e){console.log(e),y.a.error({message:"Get list of devices failed!",description:"Unable to retrieve the list of your devices, please try again later"})},success:function(t){console.log(t),e&&e(t)}})});Object(a.useEffect)((function(){j((function(e){o(e.results),l({current:i.current,pageSize:i.pageSize,total:e.count})}))}),[]);var p=[{title:"ID",dataIndex:"id",key:"id"},{title:"Devices",dataIndex:"devices",key:"devices"},{title:"Signed in date",dataIndex:"created",key:"created",render:function(e){return Object(S.jsx)("div",{children:new Date(Date.parse(e)).toString()})}},{title:"Actions",dataIndex:"id",key:"id",render:function(e){return Object(S.jsx)("div",{children:Object(S.jsx)("button",{className:"btn btn-danger float-end",onClick:function(){return function(e,t){v.a.ajax({type:"POST",url:"https://sv-communityadvocates.org/api/react/remove-device/",headers:{Authorization:"token "+localStorage.token},data:{tokenid:e},error:function(e){console.log(e),y.a.error({message:"Action failed",description:"An error has happened, no device is logged out"})},success:function(e){console.log(e),y.a.success({message:"Device removed",description:"You have logged out from a device."}),j((function(e){o(e.results),l({current:i.current,pageSize:i.pageSize,total:e.count})})),t&&t(e)}})}(e)},children:Object(S.jsx)("i",{class:"far fa-trash-alt"})})})}}];return Object(S.jsx)("div",{className:"container",children:Object(S.jsxs)("div",{className:"container-md rounded-3 p-3 m-3",children:[Object(S.jsx)(w.a,{orientation:"left",children:Object(S.jsx)("h2",{children:"List of signed in devices"})}),Object(S.jsx)("button",{className:"btn btn-danger float-end",style:{margin:"1rem"},onClick:function(){v.a.ajax({type:"POST",url:"https://sv-communityadvocates.org/api/react/logout-all/",headers:{Authorization:"token "+localStorage.token},error:function(e){console.log(e),y.a.error({message:"Action failed",description:"An error has happened, no device is logged out"})},success:function(e){console.log(e),y.a.success({message:"Device removed",description:"You have logged out from all other device."}),j((function(e){o(e.results),l({current:i.current,pageSize:i.pageSize,total:e.count})}))}})},children:"Delete all"}),Object(S.jsx)("div",{className:"container",children:Object(S.jsx)(N.a,{dataSource:n,columns:p,pagination:i,loading:m,onChange:function(e,t,s){var a,n;console.log(e),l(e),a=e,n=function(t){o(t.results),l({current:e.current,pageSize:e.pageSize,total:t.count})},v.a.ajax({type:"GET",url:"https://sv-communityadvocates.org/api/react/list-devices/",headers:{Authorization:"token "+localStorage.token},data:Object(b.a)({},a),error:function(e){y.a.error({message:"Get list of devices failed!",description:"Unable to retrieve the list of your devices, please try again later"}),console.log(e)},success:function(e){console.log(e),n&&n(e)}})}})})]})})},_=s(245),P=s(67);var A=function(e){var t=_.a.useForm(),s=Object(g.a)(t,1)[0];return Object(S.jsx)("div",{className:"container",children:Object(S.jsxs)("div",{className:"container-md rounded-3 p-3 m-3",children:[Object(S.jsx)(w.a,{orientation:"left",children:Object(S.jsx)("h2",{children:"Change password"})}),Object(S.jsxs)(_.a,{name:"passwordChange",layout:"vertical",form:s,initialValues:{old_password:"",new_password:"",repeat_new_password:""},onFinish:function(e){console.log(e),v.a.ajax({type:"PATCH",url:"https://sv-communityadvocates.org/api/react/change-password/",data:e,headers:{Authorization:"token "+localStorage.token},error:function(e){console.log(e),y.a.error({message:"Password update failed",description:"An error happened: "+e.responseJSON.detail})},success:function(t){var a,n;console.log(t),s.resetFields(),y.a.success({message:"Password update successfully",description:"Your password has beed update successfully"}),e.signout&&(a=function(e){y.a.success({message:"All device logged out successfully",description:"All other devices have been logged out successfully"})},v.a.ajax({type:"POST",url:"https://sv-communityadvocates.org/api/react/logout-all/",headers:{Authorization:"token "+localStorage.token},error:function(e){console.log(e),n&&n(e)},success:function(e){console.log(e),a&&a(e)}}))}})},onFinishFailed:function(e){console.log(e)},children:[Object(S.jsx)(_.a.Item,{label:"Old password",name:"old_password",rules:[{required:!0,message:"Please inpupt your old password!"}],children:Object(S.jsx)("input",{type:"password",className:"form-control"})}),Object(S.jsx)(_.a.Item,{label:"New password",name:"new_password",hasFeedback:!0,rules:[{required:!0,message:"Please inpupt your new password!"}],children:Object(S.jsx)("input",{type:"password",className:"form-control"})}),Object(S.jsx)(_.a.Item,{label:"Confirm new password",name:"repeat_new_password",dependencies:["new_password"],hasFeedback:!0,rules:[{required:!0,message:"Please input your new password again!"},function(e){var t=e.getFieldValue;return{validator:function(e,s){return s&&t("new_password")!==s?Promise.reject(new Error("The two passwords that you entered do not match!")):Promise.resolve()}}}],children:Object(S.jsx)("input",{type:"password",className:"form-control"})}),Object(S.jsx)(_.a.Item,{name:"signout",valuePropName:"checked",children:Object(S.jsx)(P.a,{children:"Sign out all other devices"})}),Object(S.jsx)(_.a.Item,{style:{float:"right"},children:Object(S.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Submit"})})]})]})})},z=s(254),C=s.n(z),I=h.a.Content,T=h.a.Sider,V=function(e){Object(d.a)(s,e);var t=Object(u.a)(s);function s(e){var a;return Object(r.a)(this,s),(a=t.call(this,e)).toggle=function(){a.setState({collapsed:!a.state.collapsed})},a.checkPermission=function(e,t,s){v.a.ajax({type:"POST",url:"https://sv-communityadvocates.org/api/react/check-permission/",headers:{Authorization:"token "+localStorage.token},data:{permission:e},error:function(e){s&&s(e)},success:function(e){t&&t(e)}})},a.state={id:null,collapsed:!0,isSuperUser:!1,groups:[]},Object(p.getLogin)((function(e){console.log(e),a.setState({username:e.username,firstname:e.first_name,groups:e.groups})})),a.checkPermission("is_super_user",(function(e){a.setState({isSuperUser:!0})}),(function(e){a.setState({isSuperUser:!1})})),a.toggle=a.toggle.bind(Object(l.a)(a)),a.checkPermission=a.checkPermission.bind(Object(l.a)(a)),a}return Object(i.a)(s,[{key:"render",value:function(){var e=this;return Object(S.jsx)("div",{children:Object(S.jsxs)(h.a,{children:[Object(S.jsx)(j.a,{siteName:"SVCA",username:this.state.username}),Object(S.jsxs)(h.a,{children:[Object(S.jsx)(T,{theme:"light",trigger:null,collapsible:!0,collapsed:this.state.collapsed,children:Object(S.jsx)(C.a,{permission_groups:this.state.groups,selected:"2",collapsed:this.state.collapsed,toggle:function(){return e.toggle()}})}),Object(S.jsx)(h.a,{className:"site-layout",style:{background:"white"},children:Object(S.jsx)(I,{className:"site-layout-background",children:Object(S.jsxs)("div",{className:"container",children:[Object(S.jsx)("h1",{children:"My Account"}),Object(S.jsx)(k,{}),Object(S.jsx)(A,{}),Object(S.jsx)(F,{})]})})})]})]})})}}]),s}(n.a.Component),E=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,363)).then((function(t){var s=t.getCLS,a=t.getFID,n=t.getFCP,o=t.getLCP,c=t.getTTFB;s(e),a(e),n(e),o(e),c(e)}))};c.a.render(Object(S.jsx)(n.a.StrictMode,{children:Object(S.jsx)(V,{})}),document.getElementById("root")),E()}},[[360,1,2]]]);
//# sourceMappingURL=main.c45f6059.chunk.js.map